#include "mj64.h"
#include "config.h"
#include "bt.h"

#include <print.h>

#if defined (mojo60_ansi)
const is31_led g_is31_leds[DRIVER_LED_TOTAL] = {
    {0, CS(30, 1), CS(29, 1), CS(28, 1)},
    {0, CS(30, 2), CS(29, 2), CS(28, 2)},
    {0, CS(30, 3), CS(29, 3), CS(28, 3)},
    {0, CS(30, 4), CS(29, 4), CS(28, 4)},
    {0, CS(30, 5), CS(29, 5), CS(28, 5)},
};

rgb_led g_rgb_leds[DRIVER_LED_TOTAL] = {
    {{0|(13<<4)},   {16*13.5,  0}, 1},
    {{0|(12<<4)},   {16*12,  0}, 1},
    {{0|(11<<4)},   {16*11,  0}, 1},
    {{0|(10<<4)},   {16*10,  0}, 1},
    {{0|(9<<4)},    {16*9,  0}, 1},
    {{0|(8<<4)},    {16*8,  0}, 1},
    {{0|(7<<4)},    {16*7,  0}, 1},
	{{0|(6<<4)},    {16*6,  0}, 1},
    {{0|(5<<4)},    {16*5,  0}, 1},
    {{0|(4<<4)},    {16*4,  0}, 1},
    {{0|(3<<4)},    {16*3,  0}, 1},
    {{0|(2<<4)},    {16*2,  0}, 1},
    {{0|(1<<4)},    {16*1,  0}, 1},
    {{0|(0<<4)},    {16*0,  0}, 1},
	{{1|(13<<4)},   {16*13.75, 16}, 1},
    {{1|(12<<4)},   {16*12.5,  16}, 4},
    {{1|(11<<4)},   {16*11.5,  16}, 4},
    {{1|(10<<4)},   {16*10.5,  16}, 4},
    {{1|(9<<4)},    { 16*9.5,  16}, 4},
    {{1|(8<<4)},    { 16*8.5,  16}, 4},
    {{1|(7<<4)},    { 16*7.5,  16}, 4},
	{{1|(6<<4)},    { 16*6.5,  16}, 4},
    {{1|(5<<4)},    { 16*5.5,  16}, 4},
    {{1|(4<<4)},    { 16*4.5,  16}, 4},
    {{1|(3<<4)},    { 16*3.5,  16}, 4},
    {{1|(2<<4)},    { 16*2.5,  16}, 4},
    {{1|(1<<4)},    { 16*1.5,  16}, 4},
    {{1|(0<<4)},    { 16*0.25,  16}, 1},
	{{2|(13<<4)},   {16*13.375,  24}, 1},
    {{2|(11<<4)},   {16*11.75,  32}, 4},
    {{2|(10<<4)},   {16*10.75,  32}, 4},
    {{2|(9<<4)},    {16*9.75,  32}, 4},
    {{2|(8<<4)},    {16*8.75,  32}, 4},
    {{2|(7<<4)},    {16*7.75,  32}, 4},
	{{2|(6<<4)},    { 16*6.75,  32}, 4},
    {{2|(5<<4)},    { 16*5.75,  32}, 4},
    {{2|(4<<4)},    { 16*4.75,  32}, 4},
    {{2|(3<<4)},    { 16*3.75,  32}, 4},
    {{2|(2<<4)},    { 16*2.75,  32}, 4},
    {{2|(1<<4)},    { 16*1.75,  32}, 4},
    {{2|(0<<4)},    { 16*0.375,  32}, 1},
    {{3|(11<<4)},   {16*13.125,  48}, 1},
    {{3|(10<<4)},   {16*11.25,  48}, 4},
    {{3|(9<<4)},    {16*10.25,  48}, 4},
    {{3|(8<<4)},    {16*9.25,  48}, 4},
    {{3|(7<<4)},    {16*8.25,  48}, 4},
	{{3|(6<<4)},    {16*7.25,  48}, 4},
    {{3|(5<<4)},    {16*6.25,  48}, 4},
    {{3|(4<<4)},    {16*5.25,  48}, 4},
    {{3|(3<<4)},    {16*4.25,  48}, 4},
    {{3|(2<<4)},    {16*3.25,  48}, 4},
    {{3|(1<<4)},    {16*1.25,  48}, 4},
    {{3|(0<<4)},    {16*0.625,  48}, 1},
	{{4|(13<<4)},   {16*13.875,  64}, 1},
    {{4|(11<<4)},   {16*12.625,  64}, 1},
    {{4|(10<<4)},   {16*11.375,  64}, 1},
    {{4|(9<<4)},    {16*10.125,  64}, 1},
    {{4|(5<<4)},    { 16*6.375,  64}, 4},
    {{4|(2<<4)},    { 16*2.625,  64}, 1},
    {{4|(1<<4)},    { 16*1.375,  64}, 1},
    {{4|(0<<4)},    { 16*0.125,  64}, 1},
};
#else
const is31_led g_is31_leds[DRIVER_LED_TOTAL] = {
    {0, CS7_SW1,  CS8_SW1,  CS9_SW1},  	/* RGB1 */
    {0, CS7_SW2,  CS8_SW2,  CS9_SW2},  	/* RGB2 */
    {0, CS7_SW3,  CS8_SW3,  CS9_SW3},  	/* RGB3 */
    {0, CS7_SW4,  CS8_SW4,  CS9_SW4},  	/* RGB4 */
    {0, CS7_SW5,  CS8_SW5,  CS9_SW5},  	/* RGB5 */
    {0, CS7_SW6,  CS8_SW6,  CS9_SW6},  	/* RGB6 */
    {0, CS7_SW7,  CS8_SW7,  CS9_SW7},  	/* RGB7 */
    {0, CS7_SW8,  CS8_SW8,  CS9_SW8},  	/* RGB8 */
    {0, CS7_SW9,  CS8_SW9,  CS9_SW9},  	/* RGB9 */

    {0, CS10_SW1, CS11_SW1, CS12_SW1},	/* RGB10 */
    {0, CS10_SW2, CS11_SW2, CS12_SW2},	/* RGB11 */
    {0, CS10_SW3, CS11_SW3, CS12_SW3},	/* RGB12 */
    {0, CS10_SW4, CS11_SW4, CS12_SW4},	/* RGB13 */
    {0, CS10_SW5, CS11_SW5, CS12_SW5},	/* RGB14 */
    {0, CS10_SW6, CS11_SW6, CS12_SW6},	/* RGB15 */
    {0, CS10_SW7, CS11_SW7, CS12_SW7},	/* RGB16 */
    {0, CS10_SW8, CS11_SW8, CS12_SW8},	/* RGB17 */
    {0, CS10_SW9, CS11_SW9, CS12_SW9},	/* RGB18 */

    {0, CS13_SW1, CS14_SW1, CS15_SW1},	/* RGB19 */
    {0, CS13_SW2, CS14_SW2, CS15_SW2},	/* RGB20 */
    {0, CS13_SW3, CS14_SW3, CS15_SW3},	/* RGB21 */
    {0, CS13_SW4, CS14_SW4, CS15_SW4},	/* RGB22 */
    {0, CS13_SW5, CS14_SW5, CS15_SW5},	/* RGB23 */
    {0, CS13_SW6, CS14_SW6, CS15_SW6},	/* RGB24 */
    {0, CS13_SW7, CS14_SW7, CS15_SW7},	/* RGB25 */
    {0, CS13_SW8, CS14_SW8, CS15_SW8},	/* RGB26 */
    {0, CS13_SW9, CS14_SW9, CS15_SW9},	/* RGB27 */

    {0, CS16_SW1, CS17_SW1, CS18_SW1},	/* RGB28 */
    {0, CS16_SW2, CS17_SW2, CS18_SW2},	/* RGB29 */
    {0, CS16_SW3, CS17_SW3, CS18_SW3},	/* RGB30 */
    {0, CS16_SW4, CS17_SW4, CS18_SW4},	/* RGB31 */
    {0, CS16_SW5, CS17_SW5, CS18_SW5},	/* RGB32 */
    {0, CS16_SW6, CS17_SW6, CS18_SW6},	/* RGB33 */
    {0, CS16_SW7, CS17_SW7, CS18_SW7},	/* RGB34 */
    {0, CS16_SW8, CS17_SW8, CS18_SW8},	/* RGB35 */
    {0, CS16_SW9, CS17_SW9, CS18_SW9},	/* RGB36 */

    {0, CS19_SW1, CS20_SW1, CS21_SW1},	/* RGB37 */
    {0, CS19_SW2, CS20_SW2, CS21_SW2},	/* RGB38 */
    {0, CS19_SW3, CS20_SW3, CS21_SW3},	/* RGB39 */
    {0, CS19_SW4, CS20_SW4, CS21_SW4},	/* RGB40 */
    {0, CS19_SW5, CS20_SW5, CS21_SW5},	/* RGB41 */
    {0, CS19_SW6, CS20_SW6, CS21_SW6},	/* RGB42 */
    {0, CS19_SW7, CS20_SW7, CS21_SW7},	/* RGB43 */
    {0, CS19_SW8, CS20_SW8, CS21_SW8},	/* RGB44 */
    {0, CS19_SW9, CS20_SW9, CS21_SW9},	/* RGB45 */

    {0, CS22_SW1, CS23_SW1, CS24_SW1},	/* RGB46 */
    {0, CS22_SW2, CS23_SW2, CS24_SW2},	/* RGB47 */
    {0, CS22_SW3, CS23_SW3, CS24_SW3},	/* RGB48 */
    {0, CS22_SW4, CS23_SW4, CS24_SW4},	/* RGB49 */
    {0, CS22_SW5, CS23_SW5, CS24_SW5},	/* RGB50 */
    {0, CS22_SW6, CS23_SW6, CS24_SW6},	/* RGB51 */
    {0, CS22_SW7, CS23_SW7, CS24_SW7},	/* RGB52 */
    {0, CS22_SW8, CS23_SW8, CS24_SW8},	/* RGB53 */
    {0, CS22_SW9, CS23_SW9, CS24_SW9},	/* RGB54 */

    {0, CS25_SW1, CS26_SW1, CS27_SW1},	/* RGB55 */
    {0, CS25_SW2, CS26_SW2, CS27_SW2},	/* RGB56 */
    {0, CS25_SW3, CS26_SW3, CS27_SW3},	/* RGB57 */
    {0, CS25_SW4, CS26_SW4, CS27_SW4},	/* RGB58 */
    {0, CS25_SW5, CS26_SW5, CS27_SW5},	/* RGB59 */
    {0, CS25_SW6, CS26_SW6, CS27_SW6},	/* RGB60 */
    {0, CS25_SW7, CS26_SW7, CS27_SW7},	/* RGB61 */
    {0, CS25_SW8, CS26_SW8, CS27_SW8},	/* RGB62 */
    {0, CS25_SW9, CS26_SW9, CS27_SW9},	/* RGB63 */

    {0, CS28_SW1, CS29_SW1, CS30_SW1},	/* RGB64 */
};

rgb_led g_rgb_leds[DRIVER_LED_TOTAL] = {
    {{0|(13<<4)},   {17.23*13,  0}, 1},
    {{0|(12<<4)},   {17.23*12,  0}, 1},
    {{0|(11<<4)},   {17.23*11,  0}, 1},
    {{0|(10<<4)},   {17.23*10,  0}, 1},
    {{0|(9<<4)},    {17.23*9,  0}, 1},
    {{0|(8<<4)},    {17.23*8,  0}, 1},
    {{0|(7<<4)},    {17.23*7,  0}, 1},
	{{0|(6<<4)},    { 17.23*6,  0}, 1},
    {{0|(5<<4)},    { 17.23*5,  0}, 1},
    {{0|(4<<4)},    { 17.23*4,  0}, 1},
    {{0|(3<<4)},    { 17.23*3,  0}, 1},
    {{0|(2<<4)},    { 17.23*2,  0}, 1},
    {{0|(1<<4)},    { 17.23*1,  0}, 1},
    {{0|(0<<4)},    { 17.23*0,  0}, 1},
	{{1|(13<<4)},   {17.23*13,  16}, 1},
    {{1|(12<<4)},   {17.23*12,  16}, 4},
    {{1|(11<<4)},   {17.23*11,  16}, 4},
    {{1|(10<<4)},   {17.23*10,  16}, 4},
    {{1|(9<<4)},    {17.23*9,  16}, 4},
    {{1|(8<<4)},    {17.23*8,  16}, 4},
    {{1|(7<<4)},    {17.23*7,  16}, 4},
	{{1|(6<<4)},    { 17.23*6,  16}, 4},
    {{1|(5<<4)},    { 17.23*5,  16}, 4},
    {{1|(4<<4)},    { 17.23*4,  16}, 4},
    {{1|(3<<4)},    { 17.23*3,  16}, 4},
    {{1|(2<<4)},    { 17.23*2,  16}, 4},
    {{1|(1<<4)},    { 17.23*1,  16}, 4},
    {{1|(0<<4)},    { 17.23*0,  16}, 1},
	{{2|(13<<4)},   {17.23*13,  32}, 1},
    {{2|(11<<4)},   {17.23*11,  32}, 4},
    {{2|(10<<4)},   {17.23*10,  32}, 4},
    {{2|(9<<4)},    {17.23*9,  32}, 4},
    {{2|(8<<4)},    {17.23*8,  32}, 4},
    {{2|(7<<4)},    {17.23*7,  32}, 4},
	{{2|(6<<4)},    { 17.23*6,  32}, 4},
    {{2|(5<<4)},    { 17.23*5,  32}, 4},
    {{2|(4<<4)},    { 17.23*4,  32}, 4},
    {{2|(3<<4)},    { 17.23*3,  32}, 4},
    {{2|(2<<4)},    { 17.23*2,  32}, 4},
    {{2|(1<<4)},    { 17.23*1,  32}, 4},
    {{2|(0<<4)},    { 17.23*0,  32}, 1},
	{{3|(13<<4)},   {17.23*13,  48}, 1},
    {{3|(11<<4)},   {17.23*11,  48}, 4},
    {{3|(10<<4)},   {17.23*10,  48}, 4},
    {{3|(9<<4)},    {17.23*9,  48}, 4},
    {{3|(8<<4)},    {17.23*8,  48}, 4},
    {{3|(7<<4)},    {17.23*7,  48}, 4},
	{{3|(6<<4)},    { 17.23*6,  48}, 4},
    {{3|(5<<4)},    { 17.23*5,  48}, 4},
    {{3|(4<<4)},    { 17.23*4,  48}, 4},
    {{3|(3<<4)},    { 17.23*3,  48}, 4},
    {{3|(2<<4)},    { 17.23*2,  48}, 4},
    {{3|(1<<4)},    { 17.23*1,  48}, 4},
    {{3|(0<<4)},    { 17.23*0,  48}, 1},
	{{4|(13<<4)},   {17.23*13,  64}, 1},
    {{4|(11<<4)},   {17.23*11,  64}, 1},
    {{4|(10<<4)},   {17.23*10,  64}, 1},
    {{4|(9<<4)},    {17.23*9,  64}, 1},
    {{4|(8<<4)},    {17.23*8,  64}, 1},
    {{4|(5<<4)},    { 17.23*5,  64}, 4},
    {{4|(2<<4)},    { 17.23*2,  64}, 1},
};
#endif

void matrix_init_kb(void)
{
    matrix_init_user();
}

void matrix_scan_kb(void)
{
    matrix_scan_user();
}

bool process_record_kb(uint16_t keycode, keyrecord_t *record)
{
    return process_record_user(keycode, record);
}

void suspend_power_down_kb(void)
{
    rgb_matrix_set_suspend_state(true);
    suspend_power_down_user();
}

void suspend_wakeup_init_kb(void)
{
    rgb_matrix_set_suspend_state(false);
    suspend_wakeup_init_user();
}

void matrix_setup(void)
{
	palSetPadMode(GPIOA, 2, PAL_MODE_OUTPUT_PUSHPULL);
	palSetPad(GPIOA, 2);
}
